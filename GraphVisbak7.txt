#:kivy  1.8.0

<TagWidget>:
	target_x: 0
	target_y: 0
	target_pos: self.target_x, self.target_y
	target_radius: 20
	size_hint: None, None
	size: self.target_radius, self.target_radius
	
	border:15
	char_width: 7
	char_height: 40
	tag: "<insert tag>"
	
	pos_hint: {'center_x': self.target_x, 'center_y': self.target_y}
	
	Bubble:
		center_x: root.center_x
		y: root.top
		size_hint: None, None
		size: len(root.tag)*root.char_width + root.border*2, root.char_height
		Label:
			text: root.tag

<GraphItems>:
	scale_index: 20
	size_hint: None, None
	size: self.scale_index, self.scale_index
	
<GraphWidget>:
	scale_index: 20
	bounding_box: 0, 0

<CircularButton@Button>
	radius: 1
	size_hint: None, None
	size: self.radius, self.radius
	border: 0,0,0,0
	
	color: .4, .7, 1, 1
	
	background_color: self.color
	
	#background_down_backup: self.background_down
	background_down: self.background_normal
	
	#on_press: self.background_down = self.background_normal
	on_release:
		self.background_color = self.color
		
<Node>:
	tag:"<node_tag>"
	radius: 40	#to be patched (something weird happens if you set it to 1)
	color: .4, .7, 1, 1
	active_color: .6, .9, 1, 1
	
	size: self.radius, self.radius
	
	pos_x: 0
	pos_y: 0
	
	pos_hint: {'center_x': self.pos_x, 'center_y': self.pos_y}
	
	CircularButton:
		id: handle
		radius: root.radius
		
		background_normal: 'node_normal.png'
		
		center_x: root.center_x
		center_y: root.center_y
	
<Edge>:
	tag: "<edge_tag>"
	handle_size: 20
	color: .4, .7, 1, 1
	active_color: .6, .9, 1, 1
	
	tail_x: 0
	tail_y: 0
	head_x: 1
	head_y: 1
	
	x_mod: 1
	y_mod: 1
	
	size_hint: self.head_x - self.tail_x, self.head_y - self.tail_y
	pos_hint: {'x': self.tail_x, 'y': self.tail_y}

	canvas:
		Color: 
			rgb: 0,0,0
		Line:
			width: 2
			points: self.x, self.y, self.x + self.width*self.x_mod, self.y + self.height*self.y_mod

	CircularButton:
		id: handle
		radius: root.handle_size
		background_normal: 'edge_normal.png'
		center_x: root.x + root.width*root.x_mod*0.5
		center_y: root.y + root.height*root.y_mod*0.5
		on_press:
			print "edgy"
	
<ScreenWidget>:
	#THIS EXISTS#

<TreeVisualizer>:
	
	scale_index: 60
	node_radius: 40
	graph_width: 100
	graph_height: 100
	graph_size: self.graph_width, self.graph_height
	item_pos: 0, 0

    canvas:
        Color:
            rgb: 1, 0.9999, 0.999
        Rectangle:
            pos: 0, 0
            size: self.size
			
	GraphWidget:
		id: graph
		center: 190, 240
		x_units: root.graph_width
		y_units: root.graph_height
		scale_index: root.scale_index
		size: self.x_units*self.scale_index + root.node_radius, self.y_units*self.scale_index + root.node_radius
	
		item_pos: self.x + root.item_pos[0]*self.scale_index + root.node_radius*0.5, self.y + root.item_pos[1]*self.scale_index + root.node_radius*0.5
		
		canvas:
			Color:
				rgba: 1, 0.5, 1, 0.2
			Rectangle:
				pos: self.pos
				size: self.size
		
		GraphItems:
			pos: graph.item_pos
			id: graph_items
			scale_index: graph.scale_index
		
	ScreenWidget:
		id: screen