#:kivy  1.8.0

<InfoWidget>:
	tag: "<insert tag>"
	Label:
		text: root.tag

<GraphItems>:
	scale_index:20
	size_hint: None, None
	size: self.scale_index, self.scale_index
	
<GraphWidget>:
	bounding_box: 0, 0

<CircularButton@Button>
	radius: 1
	size_hint: None, None
	size: self.radius, self.radius
	border: 0,0,0,0
	
	color: .4, .7, 1, 1
	
	background_color: self.color
	
	#background_down_backup: self.background_down
	background_down: self.background_normal
	
	#on_press: self.background_down = self.background_normal
	on_release:
		self.background_color = self.color
		
<Node>:
	tag:"<node_tag>"
	radius: 40	#to be patched (something weird happens if you set it to 1)
	color: .4, .7, 1, 1
	active_color: .6, .9, 1, 1
	
	size: self.radius, self.radius
	
	pos_x: 0
	pos_y: 0
	
	pos_hint: {'center_x': self.pos_x, 'center_y': self.pos_y}
	
	CircularButton:
		id: handle
		radius: root.radius
		
		background_normal: 'node_normal.png'
		
		center_x: root.center_x
		center_y: root.center_y
		
	InfoWidget:
		size_hint: (1.4, 0.7)
		pos_hint: {'center_x': 0.5, 'y': 0.85}
		
		tag: root.tag
	
<Edge>:
	tag: "<edge_tag>"
	handle_size: 20
	color: .4, .7, 1, 1
	active_color: .6, .9, 1, 1
	
	tail_x: 0
	tail_y: 0
	head_x: 1
	head_y: 1
	
	x_mod: 1
	y_mod: 1
	
	size_hint: self.head_x - self.tail_x, self.head_y - self.tail_y
	pos_hint: {'x': self.tail_x, 'y': self.tail_y}

	canvas:
		Color: 
			rgb: 0,0,0
		Line:
			width: 2
			points: self.x, self.y, self.x + self.width*self.x_mod, self.y + self.height*self.y_mod

	CircularButton:
		id: handle
		radius: root.handle_size
		background_normal: 'edge_normal.png'
		center_x: root.x + root.width*root.x_mod*0.5
		center_y: root.y + root.height*root.y_mod*0.5
		on_press:
			print "edgy"
		
		InfoWidget:
			size: handle.radius*5, + handle.radius
			center_x: handle.center_x
			center_y: handle.center_y + handle.radius
		
			tag: root.tag
	
<ScreenWidget>:
	#THIS EXISTS#

<TreeVisualizer>:

	graph_size: 100,100
	scale_index: 60
	node_radius: 40

    canvas:
        Color:
            rgb: 1, 0.9999, 0.999
        Rectangle:
            pos: 0, 0
            size: self.size
			
	GraphWidget:
		id: graph
		pos: root.pos
		size: root.graph_size
		
		GraphItems:
			pos: graph.pos
			id: graph_edges
			scale_index: root.scale_index
		GraphItems:
			pos: graph.pos
			id: graph_nodes
			scale_index: root.scale_index
		
	ScreenWidget:
		id: screen